# הגדרת משימות מבוססות-חשמל ב-Task Scheduler
מדריך זה מתאר שתי שיטות להפעלת תוכנית Battery Alert בהתבסס על מצב החשמל של המחשב.

## תוכן עניינים
- [שיטה 1: בדיקה תקופתית](#שיטה-1-בדיקה-תקופתית)
- [שיטה 2: הפעלה מבוססת אירועים](#שיטה-2-הפעלה-מבוססת-אירועים)
- [השוואה בין השיטות](#השוואה-בין-השיטות)

## הערה חשובה לפני ההגדרה
לפני הגדרת Task Scheduler, וודא שהתקנת את הפרויקט לפי ההוראות ב-README.md והסביבה הוירטואלית פועלת כראוי.

## שיטה 1: בדיקה תקופתית
שיטה זו בודקת את מצב החשמל כל פרק זמן קבוע (למשל כל 5 דקות).

### שלבי ההגדרה:

1. **פתיחת Task Scheduler**
   - פתח את Task Scheduler דרך Start Menu
   - בחר Create Task (לא Basic Task)

2. **הגדרות כלליות (General)**
   - Name: Battery Alert Monitor
   - Description: מנטר את מצב הסוללה ומתריע כשהיא מגיעה לאחוז טעינה מסוים
   - סמן "Run with highest privileges"
   - בחר "Run only when user is logged on" כדי לראות את חלון הפלט

3. **הגדרת Triggers**
   - לחץ New בלשונית Triggers
   - בחר Daily
   - הגדר שעת התחלה (למשל 00:00)
   - תחת Advanced Settings:
     - סמן "Repeat task every: 5 minutes"
     - בחר "for a duration of: 1 day"
     - וודא שמסומן Enabled

4. **הגדרת Conditions**
   - בלשונית Conditions
   - תחת Power:
     - סמן "Start the task only if the computer is on AC power"
     - בטל סימון של "Stop if the computer switches to battery power"

5. **הגדרת Actions**
   - לחץ New בלשונית Actions
   - Action: Start a Program
   - Program/script: הכנס את הנתיב לסביבה הוירטואלית (למשל `C:\path\to\your\venv\Scripts\python.exe`)
   - Add arguments: הכנס את הנתיב המלא ל-`battery_alert.py`
   - Start in: הכנס את הנתיב לתיקיית הפרויקט

6. **הגדרות נוספות (Settings)**
   - סמן "Allow task to be run on demand"
   - סמן "Run task as soon as possible after a scheduled start is missed"
   - בחר "Do not start a new instance"

### התנהגות
- בודק כל 5 דקות את מצב החשמל
- מפעיל את הסקריפט כשהמחשב על חשמל
- יכול להיות עיכוב של עד 5 דקות בתגובה לשינויי מצב חשמל

## שיטה 2: הפעלה מבוססת אירועים
שיטה זו מגיבה מיד לשינויים במצב החשמל.

### שלבי ההגדרה:

1. **פתיחת Task Scheduler**
   - כמו בשיטה 1

2. **הגדרות כלליות**
   - זהה לשיטה 1

3. **הגדרת Triggers**
   - לחץ New בלשונית Triggers
   - בחר "On an event"
   - תחת Log בחר: System
   - תחת Source בחר: Kernel-Power
   - הגדר שני Event IDs:
     - Event ID 105 (חיבור לחשמל)
     - Event ID 185 (ניתוק מחשמל)

4. **הגדרת Actions**
   צור שתי פעולות:
   - פעולה 1 (להפעלה):
     - Program/script: נתיב ל-Python
     - Arguments: שם הסקריפט שלך
   - פעולה 2 (לכיבוי):
     - Program/script: `taskkill`
     - Arguments: `/F /IM python.exe`

5. **הגדרות נוספות**
   - זהה לשיטה 1

### התנהגות
- מגיב מיד לשינויים במצב החשמל
- מפעיל את הסקריפט ברגע החיבור לחשמל
- סוגר את הסקריפט ברגע הניתוק מחשמל

## השוואה בין השיטות

### שיטה 1 (בדיקה תקופתית)
יתרונות:
- פשוטה להגדרה
- יציבה יותר
- פחות רגישה לשינויים קצרים במצב החשמל

חסרונות:
- עיכוב בתגובה (עד 5 דקות)
- צורכת יותר משאבי מערכת בגלל הבדיקות התכופות

### שיטה 2 (מבוססת אירועים)
יתרונות:
- תגובה מיידית לשינויים
- יעילה יותר מבחינת משאבי מערכת
- סגירה מיידית בניתוק חשמל

חסרונות:
- מורכבת יותר להגדרה
- עלולה להיות רגישה מדי לשינויים קצרים
- צריך להגדיר פעולת סגירה נפרדת

## טיפים נוספים
1. מומלץ לבדוק את הלוגים של Task Scheduler אחרי ההגדרה
2. אפשר להוסיף לוגים לסקריפט הפייתון כדי לעקוב אחר הפעילות
3. כדאי לבדוק שהסקריפט נסגר כראוי בסיום הריצה
4. אם אתה משתמש בסביבה וירטואלית, וודא שאתה משתמש בנתיב המלא לפייתון של הסביבה הוירטואלית
5. אם אתה רוצה לשנות את אחוז הסוללה המטרה, ערוך את הקובץ `battery_alert.py` לפני הגדרת המשימה
